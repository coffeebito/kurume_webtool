<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover, interactive-widget=resizes-content">
    <title>ボードゲーム得点管理</title>

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="得点管理">

    <meta name="mobile-web-app-capable" content="yes">

    <meta name="description" content="ボードゲーム用の得点管理アプリ">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="main-screen" id="mainScreen">
            <div class="mode-toggle">
                <button class="toggle-btn" id="personalModeBtn" onclick="switchToPersonalMode()">3人モード</button>
                <button class="toggle-btn active" id="multiModeBtn" onclick="switchToMultiMode()">4人モード</button>
                <span class="round-divider">|</span>
                <button class="toggle-btn" id="helpBtn" onclick="showHelpModal()">説明書</button>
            </div>
            <div class="round-toggle" id="roundToggle">
                <button class="round-btn active" type="button" data-round="0" onclick="setCurrentRound(0)">R1</button>
                <button class="round-btn" type="button" data-round="1" onclick="setCurrentRound(1)">R2</button>
                <button class="round-btn" type="button" data-round="2" onclick="setCurrentRound(2)">R3</button>
                <button class="round-btn" type="button" data-round="3" onclick="setCurrentRound(3)">R4</button>
                <span class="round-divider">|</span>
                <button class="round-btn reset-btn" type="button" onclick="showResetConfirmation()">初期化</button>
            </div>
            <div class="multi-player-section" id="personalSection" style="display: none;">
                <div class="section-title"><span class="section-title-text">プレイヤー暫定点</span></div>
                <div class="player-rows-container" id="personalRowsContainer">
                    <div class="player-row">
                        <button class="player-row-btn negative btn-minus-10" onclick="updatePersonalScore(1, -10)">-10</button>
                        <button class="player-row-btn negative btn-minus-5" onclick="updatePersonalScore(1, -5)">-5</button>
                        <button class="player-row-btn negative btn-minus-1" onclick="updatePersonalScore(1, -1)">-1</button>
                        <div class="player-row-score" id="personalPlayer1TempScore">0</div>
                        <button class="player-row-btn positive btn-plus-1" onclick="updatePersonalScore(1, 1)">+1</button>
                        <button class="player-row-btn positive btn-plus-5" onclick="updatePersonalScore(1, 5)">+5</button>
                        <button class="player-row-btn positive btn-plus-10" onclick="updatePersonalScore(1, 10)">+10</button>
                    </div>

                    <div class="player-row">
                        <button class="player-row-btn negative btn-minus-10" onclick="updatePersonalScore(2, -10)">-10</button>
                        <button class="player-row-btn negative btn-minus-5" onclick="updatePersonalScore(2, -5)">-5</button>
                        <button class="player-row-btn negative btn-minus-1" onclick="updatePersonalScore(2, -1)">-1</button>
                        <div class="player-row-score" id="personalPlayer2TempScore">0</div>
                        <button class="player-row-btn positive btn-plus-1" onclick="updatePersonalScore(2, 1)">+1</button>
                        <button class="player-row-btn positive btn-plus-5" onclick="updatePersonalScore(2, 5)">+5</button>
                        <button class="player-row-btn positive btn-plus-10" onclick="updatePersonalScore(2, 10)">+10</button>
                    </div>

                    <div class="player-row">
                        <button class="player-row-btn negative btn-minus-10" onclick="updatePersonalScore(3, -10)">-10</button>
                        <button class="player-row-btn negative btn-minus-5" onclick="updatePersonalScore(3, -5)">-5</button>
                        <button class="player-row-btn negative btn-minus-1" onclick="updatePersonalScore(3, -1)">-1</button>
                        <div class="player-row-score" id="personalPlayer3TempScore">0</div>
                        <button class="player-row-btn positive btn-plus-1" onclick="updatePersonalScore(3, 1)">+1</button>
                        <button class="player-row-btn positive btn-plus-5" onclick="updatePersonalScore(3, 5)">+5</button>
                        <button class="player-row-btn positive btn-plus-10" onclick="updatePersonalScore(3, 10)">+10</button>
                    </div>
                </div>
            </div>

            <div class="multi-player-section" id="multiPlayerSection" style="display: flex;">
                <div class="section-title"><span class="section-title-text">プレイヤー暫定点</span></div>
                <div class="player-rows-container">
                    <div class="player-row">
                        <button class="player-row-btn negative btn-minus-10" onclick="updateMultiPlayerScore(1, -10)">-10</button>
                        <button class="player-row-btn negative btn-minus-5" onclick="updateMultiPlayerScore(1, -5)">-5</button>
                        <button class="player-row-btn negative btn-minus-1" onclick="updateMultiPlayerScore(1, -1)">-1</button>
                        <div class="player-row-score" id="multiPlayer1Score">0</div>
                        <button class="player-row-btn positive btn-plus-1" onclick="updateMultiPlayerScore(1, 1)">+1</button>
                        <button class="player-row-btn positive btn-plus-5" onclick="updateMultiPlayerScore(1, 5)">+5</button>
                        <button class="player-row-btn positive btn-plus-10" onclick="updateMultiPlayerScore(1, 10)">+10</button>
                    </div>

                    <div class="player-row">
                        <button class="player-row-btn negative btn-minus-10" onclick="updateMultiPlayerScore(2, -10)">-10</button>
                        <button class="player-row-btn negative btn-minus-5" onclick="updateMultiPlayerScore(2, -5)">-5</button>
                        <button class="player-row-btn negative btn-minus-1" onclick="updateMultiPlayerScore(2, -1)">-1</button>
                        <div class="player-row-score" id="multiPlayer2Score">0</div>
                        <button class="player-row-btn positive btn-plus-1" onclick="updateMultiPlayerScore(2, 1)">+1</button>
                        <button class="player-row-btn positive btn-plus-5" onclick="updateMultiPlayerScore(2, 5)">+5</button>
                        <button class="player-row-btn positive btn-plus-10" onclick="updateMultiPlayerScore(2, 10)">+10</button>
                    </div>

                    <div class="player-row">
                        <button class="player-row-btn negative btn-minus-10" onclick="updateMultiPlayerScore(3, -10)">-10</button>
                        <button class="player-row-btn negative btn-minus-5" onclick="updateMultiPlayerScore(3, -5)">-5</button>
                        <button class="player-row-btn negative btn-minus-1" onclick="updateMultiPlayerScore(3, -1)">-1</button>
                        <div class="player-row-score" id="multiPlayer3Score">0</div>
                        <button class="player-row-btn positive btn-plus-1" onclick="updateMultiPlayerScore(3, 1)">+1</button>
                        <button class="player-row-btn positive btn-plus-5" onclick="updateMultiPlayerScore(3, 5)">+5</button>
                        <button class="player-row-btn positive btn-plus-10" onclick="updateMultiPlayerScore(3, 10)">+10</button>
                    </div>

                    <div class="player-row">
                        <button class="player-row-btn negative btn-minus-10" onclick="updateMultiPlayerScore(4, -10)">-10</button>
                        <button class="player-row-btn negative btn-minus-5" onclick="updateMultiPlayerScore(4, -5)">-5</button>
                        <button class="player-row-btn negative btn-minus-1" onclick="updateMultiPlayerScore(4, -1)">-1</button>
                        <div class="player-row-score" id="multiPlayer4Score">0</div>
                        <button class="player-row-btn positive btn-plus-1" onclick="updateMultiPlayerScore(4, 1)">+1</button>
                        <button class="player-row-btn positive btn-plus-5" onclick="updateMultiPlayerScore(4, 5)">+5</button>
                        <button class="player-row-btn positive btn-plus-10" onclick="updateMultiPlayerScore(4, 10)">+10</button>
                    </div>
                </div>
            </div>

            <div class="summary-wrapper" id="personalSummaryWrapper" style="display: none;">
                <div class="summary-section">
                    <div class="summary-title">確定点</div>
                    <div class="players-summary multi-mode" id="personalPlayersSummary">
                        <div class="player-card" id="personalPlayer1Card">
                            <div class="player-score" id="personalPlayer1TotalScore">0</div>
                        </div>
                        <div class="player-card" id="personalPlayer2Card">
                            <div class="player-score" id="personalPlayer2TotalScore">0</div>
                        </div>
                        <div class="player-card" id="personalPlayer3Card">
                            <div class="player-score" id="personalPlayer3TotalScore">0</div>
                        </div>
                    </div>
                </div>
                <div class="status-section" id="personalStatusSection">
                    <div class="status-title">生還/脱落 記録</div>
                    <div class="status-rows">
                        <div class="status-row red">
                            <label class="status-toggle">
                                <span class="status-toggle-text">生還</span>
                                <input class="status-switch-input" type="checkbox" data-player="0" onchange="handlePersonalStatusToggle(this)">
                                <span class="status-switch-track is-out">
                                    <span class="status-switch-option option-light"></span>
                                    <span class="status-switch-option option-dark"></span>
                                    <span class="status-switch-thumb"></span>
                                </span>
                                <span class="status-state-text state-out" data-player="0">移動中/脱落</span>
                            </label>
                        </div>
                        <div class="status-row yellow">
                            <label class="status-toggle">
                                <span class="status-toggle-text">生還</span>
                                <input class="status-switch-input" type="checkbox" data-player="1" onchange="handlePersonalStatusToggle(this)">
                                <span class="status-switch-track is-out">
                                    <span class="status-switch-option option-light"></span>
                                    <span class="status-switch-option option-dark"></span>
                                    <span class="status-switch-thumb"></span>
                                </span>
                                <span class="status-state-text state-out" data-player="1">移動中/脱落</span>
                            </label>
                        </div>
                        <div class="status-row green">
                            <label class="status-toggle">
                                <span class="status-toggle-text">生還</span>
                                <input class="status-switch-input" type="checkbox" data-player="2" onchange="handlePersonalStatusToggle(this)">
                                <span class="status-switch-track is-out">
                                    <span class="status-switch-option option-light"></span>
                                    <span class="status-switch-option option-dark"></span>
                                    <span class="status-switch-thumb"></span>
                                </span>
                                <span class="status-state-text state-out" data-player="2">移動中/脱落</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="summary-wrapper" id="multiSummaryWrapper" style="display: flex;">
                <div class="summary-section">
                    <div class="summary-title">確定点</div>
                    <div class="players-summary multi-mode" id="multiPlayersSummary">
                        <div class="player-card" id="multiPlayer1Card">
                            <div class="player-score" id="multiPlayer1TotalScore">0</div>
                        </div>
                        <div class="player-card" id="multiPlayer2Card">
                            <div class="player-score" id="multiPlayer2TotalScore">0</div>
                        </div>
                        <div class="player-card" id="multiPlayer3Card">
                            <div class="player-score" id="multiPlayer3TotalScore">0</div>
                        </div>
                        <div class="player-card" id="multiPlayer4Card">
                            <div class="player-score" id="multiPlayer4TotalScore">0</div>
                        </div>
                    </div>
                </div>
                <div class="status-section" id="multiStatusSection">
                    <div class="status-title">生還/脱落 記録</div>
                    <div class="status-rows">
                        <div class="status-row red">
                            <label class="status-toggle">
                                <span class="status-toggle-text">生還</span>
                                <input class="status-switch-input" type="checkbox" data-player="0" onchange="handleStatusToggle(this)">
                                <span class="status-switch-track is-out">
                                    <span class="status-switch-option option-light"></span>
                                    <span class="status-switch-option option-dark"></span>
                                    <span class="status-switch-thumb"></span>
                                </span>
                                <span class="status-state-text state-out" data-player="0">移動中/脱落</span>
                            </label>
                        </div>
                        <div class="status-row yellow">
                            <label class="status-toggle">
                                <span class="status-toggle-text">生還</span>
                                <input class="status-switch-input" type="checkbox" data-player="1" onchange="handleStatusToggle(this)">
                                <span class="status-switch-track is-out">
                                    <span class="status-switch-option option-light"></span>
                                    <span class="status-switch-option option-dark"></span>
                                    <span class="status-switch-thumb"></span>
                                </span>
                                <span class="status-state-text state-out" data-player="1">移動中/脱落</span>
                            </label>
                        </div>
                        <div class="status-row green">
                            <label class="status-toggle">
                                <span class="status-toggle-text">生還</span>
                                <input class="status-switch-input" type="checkbox" data-player="2" onchange="handleStatusToggle(this)">
                                <span class="status-switch-track is-out">
                                    <span class="status-switch-option option-light"></span>
                                    <span class="status-switch-option option-dark"></span>
                                    <span class="status-switch-thumb"></span>
                                </span>
                                <span class="status-state-text state-out" data-player="2">移動中/脱落</span>
                            </label>
                        </div>
                        <div class="status-row blue">
                            <label class="status-toggle">
                                <span class="status-toggle-text">生還</span>
                                <input class="status-switch-input" type="checkbox" data-player="3" onchange="handleStatusToggle(this)">
                                <span class="status-switch-track is-out">
                                    <span class="status-switch-option option-light"></span>
                                    <span class="status-switch-option option-dark"></span>
                                    <span class="status-switch-thumb"></span>
                                </span>
                                <span class="status-state-text state-out" data-player="3">移動中/脱落</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
    </div>

    <div class="modal-overlay" id="resetModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-message">全てのカウントを0にしても良いですか？</div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-cancel" onclick="hideResetConfirmation()">前の画面に戻る</button>
                <button class="modal-btn modal-btn-confirm" onclick="confirmReset()">初期化する</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="helpModal" style="display: none;">
        <div class="modal-content modal-content-large">
            <div class="modal-title">使い方</div>
            <div class="help-content">
                <div class="help-section help-image-section">
                    <img src="https://pon-navi.net/nazuke/name/fortune/img/%E7%AF%A0%E5%8E%9F/%E5%87%AA" alt="説明画像" class="help-image">
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-confirm" onclick="hideHelpModal()">始める</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
